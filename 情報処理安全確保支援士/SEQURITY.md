# 情報処理安全確保支援士  

## サーバ証明証  

- `authorityKeyIndentifier` - 認証局識別子  
- `commonName` - サブドメインまでを含んだドメイン部分 = FQDN  
- `issuer` - CAの名称  
- `serialNumber` - 証明書を一意に識別するための番号。発行者(CA)が割り当てる。  
- `subject` - 証明書の所有者の名前です。発行者と同じく DN で記述されます。ユーザの名前やサーバー名などが記述されます。  
- `subjectAltName` - 通称SAN、Subjectの別名  
- `subjectPublicKeyInfo` - 証明書所有者（主体者）の公開鍵に関する情報  
- `dNSName` - SANのこと  

## XSS（クロスサイトスクリプティング）  

クロスサイトスクリプティング（XSS）はインターネット掲示板など動的なWebサイトにある入力フォームの脆弱性を狙ったもの  

### 反射型XSS  

ユーザからのリクエストに含まれるスクリプトに相当する文字列を、ウェブアプリケーションが当該リクエストへのレスポンス（ウェブページ）内にスクリプトとして出力してしまうタイプの XSS で
す。スクリプトはリクエストの送信者へ返ることから、反射型クロスサイト・スクリプティング（Reflected XSS）と呼ばれています。

### 格納型/蓄積型/持続型XSS  

ユーザからのリクエストに含まれるスクリプトに相当する文字列を、ウェブアプリケーション内部に永続的に保存し、保存した文字列をスクリプトとしてウェブページに出力してしまうタイプの XSSです。ユーザが当該ページを閲覧するたびに、ウェブアプリケーションに保存された文字列がスクリプトとして実行されることから、格納型クロスサイト・スクリプティング（Stored XSS）と呼ばれています

### DOM Based XSS  

ウェブページに含まれる正規のスクリプトにより、動的にウェブページを操作した結果、意図しないスクリプトをウェブページに出力してしまうタイプの XSS です。ウェブページを操作する際の取決
めをDOMと呼ぶことから、このタイプのXSSはDOMベースのクロスサイト・スクリプティング（DOM Based XSS）と呼ばれています。

### 対策  

- サニタイジング（エスケープ）処理  
- バリデーション処理（入力値の制限）  
- WAFを設置する  
- Content-Security-Policyでdefault-src:selfにする  


## クロスサイトリクエストフォージェリ（CSRF）  

ウェブサイトの中には、サービスの提供に際しログイン機能を設けているものがあります。
ここで、ログインした利用者からのリクエストについて、その利用者が意図したリクエストであるかどうかを識別する仕組みを持たないウェブサイトは、外部サイトを経由した悪意のあるリクエストを受け入れてしまう場合があります。
このようなウェブサイトにログインした利用者は、悪意のある人が用意した罠により、利用者が予期しない処理を実行させられてしまう可能性があります。
このような問題を「CSRF（Cross-Site Request Forgeries／クロスサイト・リクエスト・フォージェリ）の脆弱性」と呼び、これを悪用した攻撃を、「CSRF攻撃」と呼びます。

### 対策  
- 処理を実行するページをPOSTメソッドでアクセスするようにし、その「hiddenパラメータ」に秘密情報が挿入されるよう、前のページを自動生成して、実行ページではその値が正しい場合のみ処理を実行する。  
- 処理を実行する直前のページで再度パスワードの入力を求め、実行ページでは、再度入力されたパスワードが正しい場合のみ処理を実行する。  
- Refererが正しいリンク元かを確認し、正しい場合のみ処理を実行する。  
- 重要な操作を行った際に、その旨を登録済みのメールアドレスに自動送信する。  

## SQLインジェクション  

データベースと連携したウェブアプリケーションの多くは、利用者からの入力情報を基にSQL文（データベースへの命令文）を組み立てています。
ここで、SQL文の組み立て方法に問題がある場合、攻撃によってデータベースの不正利用をまねく可能性があります。
このような問題を「SQLインジェクションの脆弱性」と呼び、問題を悪用した攻撃を、「SQLインジェクション攻撃」と呼びます。

- SQL文の組み立ては全てプレースホルダで実装する。  

    ```java
    PreparedStatement pstmt = con.prepareStatement("UPDATE EMPLOYEES
                                     SET SALARY = ? WHERE ID = ?");
    pstmt.setBigDecimal(1, 153833.00)
    pstmt.setInt(2, 110592)
    ```

- SQL文の組み立てを文字列連結により行う場合は、エスケープ処理等を行うデータベースエンジンのAPIを用いて、SQL文のリテラルを正しく構成する  
- ウェブアプリケーションに渡されるパラメータにSQL文を直接指定しない。  
- エラーメッセージをそのままブラウザに表示しない。  
    エラーメッセージの内容に、データベースの種類やエラーの原因、実行エラーを起こしたSQL文等の情報が含まれる場合、これらはSQLインジェクション攻撃につながる有用な情報となりえます。  
    また、エラーメッセージは、攻撃の手がかりを与えるだけでなく、実際に攻撃された結果を表示する情報源として悪用される場合があります。  
    データベースに関連するエラーメッセージは、利用者のブラウザ上に表示させないことをお勧めします。  
- データベースアカウントに適切な権限を与える。  
    ウェブアプリケーションがデータベースに接続する際に使用するアカウントの権限が必要以上に高い場合、攻撃による被害が深刻化する恐れがあります。  
    ウェブアプリケーションからデータベースに渡す命令文を洗い出し、その命令文の実行に必要な最小限の権限をデータベースアカウントに与えてください。  

## OSコマンドインジェクション  

ウェブアプリケーションによっては、外部からの攻撃により、ウェブサーバのOSコマンドを不正に実行されてしまう問題を持つものがあります。  
このような問題を「OSコマンド・インジェクションの脆弱性」と呼び、問題を悪用した攻撃手法を、「OSコマンド・インジェクション攻撃」と呼びます。  

- シェルを起動できる言語機能の利用を避ける。  
    ウェブアプリケーションに利用されている言語によっては、シェルを起動できる機能を持つものがあります。  
    たとえば、Perlのopen関数等です。  
    Perlのopen関数は、引数として与えるファイルパスに「|」（パイプ）を使うことでOSコマンドを実行できるため、外部からの入力値を引数として利用する実装は危険です。  
    シェルを起動できる言語機能の利用は避けて（*2）、他の関数等で代替してください。  
    Perlでファイルを開く場合、sysopen関数を利用すればシェルを起動することはありません。  

- シェルを起動できる言語機能を利用する場合は、その引数を構成する全ての変数に対してチェックを行い、あらかじめ許可した処理のみを実行する。  
    シェルを起動できる言語機能の引数を構成する変数に対し、引数に埋め込む前にチェックをかけ、本来想定する動作のみを実行するように実装してください。  
    チェック方法には、その引数に許可する文字の組み合わせを洗い出し、その組み合わせ以外は許可しない「ホワイトリスト方式」をお勧めします。  
    数値を示すはずのパラメータであれば、数字のみからなる文字列であることをチェックします。  
    チェックの結果、許可しない文字の組み合わせが確認された場合は、引数へ渡さず、処理を中止します。  

なお、チェック方法には、OSコマンド・インジェクション攻撃に悪用される記号文字（「|」、「<」、「>」等）等、問題となりうる文字を洗い出し、これを許可しない「ブラックリスト方式」もありますが、この方法はチェックに漏れが生じる可能性があるため、お勧めできません。  


## ディレクトリトラバーサル  
ウェブアプリケーションの中には、外部からのパラメータにウェブサーバ内のファイル名を直接指定しているものがあります。  
このようなウェブアプリケーションでは、ファイル名指定の実装に問題がある場合、攻撃者に任意のファイルを指定され、ウェブアプリケーションが意図しない処理を行ってしまう可能性があります。  
このような問題の一種を「ディレクトリ・トラバーサルの脆弱性」と呼び、この問題を悪用した攻撃手法の一つに、「ディレクトリ・トラバーサル攻撃」があります。  

- 外部からのパラメータでウェブサーバ内のファイル名を直接指定する実装を避ける。  

    外部からのパラメータでウェブサーバ内のファイル名を直接指定する実装では、そのパラメータが改変され、任意のファイル名を指定されることにより公開を想定しないファイルが外部から閲覧される可能性があります。  
    たとえば、HTML中のhiddenパラメータでウェブサーバ内のファイル名を指定し、そのファイルをウェブページのテンプレートとして使用する実装では、そのパラメータが改変されることで、任意のファイルをウェブページとして出力してしまう等の可能性があげられます。  
    外部からのパラメータでウェブサーバ内のファイル名を直接指定する実装が本当に必要か、他の処理方法で代替できないか等、仕様や設計から見直すことをお勧めします。  

- ファイルを開く際は、固定のディレクトリを指定し、かつファイル名にディレクトリ名が含まれないようにする。  
    たとえば、カレントディレクトリ上のファイル「filename」を開くつもりで、open(filename) の形式でコーディングしている場合、open(filename) のfilenameに絶対パス名が渡されることにより、任意ディレクトリのファイルが開いてしまう可能性があります。  
    この絶対パス名による指定を回避する方法として、あらかじめ固定のディレクトリ「dirname」を指定し、open(dirname+filename) のような形でコーディングする方法があります。  
    しかし、これだけでは、「../」等を使用したディレクトリ・トラバーサル攻撃を回避できません。  
    これを回避するために、basename() 等の、パス名からファイル名のみを取り出すAPIを利用して、open(dirname+basename(filename)) のような形でコーディングして、filenameに与えられたパス名からディレクトリ名を取り除くようにします（*1）。  

- ウェブサーバ内のファイルへのアクセス権限の設定を正しく管理する。  
    ウェブサーバ内に保管しているファイルへのアクセス権限が正しく管理されていれば、ウェブアプリケーションが任意ディレクトリのファイルを開く処理を実行しようとしても、ウェブサーバ側の機能でそのアクセスを拒否できる場合があります。  

- ファイル名のチェックを行う。  
    ファイル名を指定した入力パラメータの値から、「/」、「../」、「..\」等、OSのパス名解釈でディレクトリを指定できる文字列を検出した場合は、処理を中止します。  
    ただし、URLのデコード処理を行っている場合は、URLエンコードした「%2F」、「..%2F」、「..%5C」、さらに二重エンコードした「%252F」、「..%252F」、「..%255C」がファイル指定の入力値として有効な文字列となる場合があります。  
    チェックを行うタイミングに注意してください。  

## クリックジャッキング  
ウェブサイトの中には、ログイン機能を設け、ログインしている利用者のみが使用可能な機能を提供しているものがあります。  
該当する機能がマウス操作のみで使用可能な場合、細工された外部サイトを閲覧し操作することにより、利用者が誤操作し、意図しない機能を実行させられる可能性があります。このような問題を「クリックジャッキングの脆弱性」と呼び、問題を悪用した攻撃を、「クリックジャッキング攻撃」と呼びます。  

- HTTPレスポンスヘッダに、X-Frame-Optionsヘッダフィールドを出力し、他ドメインのサイトからのframe要素やiframe要素による読み込みを制限する。  
    X-Frame-Optionsは、ウェブアプリケーションをクリックジャッキング攻撃から防御するためのヘッダです（*1）。  
    HTTPのレスポンスヘッダに「X-Frame-Options: DENY」のように出力することで、X-Frame-Optionsに対応したブラウザにおいて、frame要素やiframe要素によるページ読み込みの制限ができます。  
    なお、Internet Explorer 7は、X-Frame-Options ヘッダに対応していないため、本対策を実施したとしても、当該ブラウザにおいてはクリックジャッキング攻撃を防げません。  

- 処理を実行する直前のページで再度パスワードの入力を求め、実行ページでは、再度入力されたパスワードが正しい場合のみ処理を実行する。  
    処理の実行前にパスワード認証を行うことにより、クリックジャッキングの脆弱性を解消できます。  
    ただし、この方法は画面設計の仕様変更を要する対策であるため、画面設計の仕様変更をせず、実装の変更だけで対策をする必要がある場合には、9-(i)-aの対策を検討してください。  

- 重要な処理は、一連の操作をマウスのみで実行できないようにする。  
    クリックジャッキング攻撃は、利用者を視覚的に騙して特定の操作をするように誘導します。  
    そのため、利用者に複雑な操作をさせることは困難です。マウス操作のみで処理が実行されないように、キーボード操作などを挟むことで攻撃の成功率を下げることができます。  

## Webの被害  

- セッションハイジャック  
- 個人情報の流出  
- Webページの改ざん  

## 用語  

- ペネトレーションテスト  
- リスクアセスメント  
- ブルートフォース攻撃  
- テンペスト攻撃  
    コンピュータ外部に漏れ出ている電磁波を捉えて解析することで情報の再現を行う攻撃  
- CRYPTREC  
    電子政府推奨暗号の安全性を評価・監視し、暗号技術の適切な実装法・運用法を調査・検討するプロジェクト  
- CRL (Certificate Revocation List)、証明書失効リスト  
    有効期間中に失効したディジタル証明書の一覧を何というか？  
- 水飲み場型攻撃  
    標的組織の従業員が頻繁にアクセスするWebサイトに攻撃コードを埋め込み、標的組織の従業員がアクセスしたときだけ攻撃が行われるようにすること。  
- データクレンジング  
    データウェアハウスを構築するために、業務システム毎に異なっているデータ属性やコード体系を統一する処理のこと。  
- タイミング攻撃  
    処理時間の差異を計測し解析し、秘密情報を推定する攻撃方法のこと。  
- ベイジアンフィルタリング  
    利用者が振り分けた迷惑メールから特徴を学習し、迷惑メールであるかどうかを統計的に解析して判定する。  
- DNSSEC  
    DNSキャッシュサーバからの応答中リソースレコードが、権威DNSサーバで管理されているもので、改ざんされていないことを検証する。  
- ダークネット  
    インターネット上で到達可能で未使用のIPアドレスの空間のこと。  
- ICMP Flood攻撃  
    pingコマンドを用いて大量の要求パケットを発信して、攻撃対象のサーバに至るまでの回線を過負荷にしてアクセスを妨害すること  
- HTTP GET Flood攻撃  
    HTTP GETコマンドを繰り返し送ることで攻撃対象のサーバにコンテンツ送信の負荷を掛けること。  
- サイバー情報共有イニシアティブ（J-CSIP）  
    検知したサイバー攻撃の情報を公的機関に集約し、高度なサイバー攻撃対策にしていく取組みのこと  
- CVE（Common Vulnerabilities and Exposures：共通脆弱性識別子）  
    CVEはソフトウェアの脆弱性の種類を識別するためのユニークなIDです。  
    MITREが中心になって1999年ごろから使用策定が行われ、AppleやRational（IBM）、OWASP、日本のIPAが協力して2008年9月9日にバージョン1.0が公開されました。  
    それ以降もメンテナンスが継続しており、現在のバージョンは2.10になっています。  
    CVE、SQLインジェクションやCSRF、XSS、バッファオーバーフローなど多種多様の脆弱性を識別するために、脆弱性の種類（脆弱性タイプ）を体系化して提供しています。  
    CVEはツリー構造になっており、MITREのサイトから大きく2つの見方で確認できます（図1）。  

- XCCDF（eXtensible Configuration Checklist Description Format：セキュリティ設定チェックリスト記述形式）  
    XCCDFは、セキュリティに関する設定のチェックリストやベンチマークをドキュメント化するために策定された、XMLで構造化されたフォーマットです。  
    NSAが中心となって開発を行い、2005年にバージョン1.0がリリースされました。  
    その後、2006年にはバージョン1.1、2011年には米国政府の支援を受けた非営利団体のMITRE社に移管されてバージョン1.2へとアップデートされています。  

- OVAL（Open Vulnerability and Assessment Language：セキュリティ検査言語）  
    OVALは、システムのセキュリティに関する設定のチェックやパッケージのバージョン情報など、セキュリティに関する検査を自動的に実行するために策定された仕様です。  

- CVSS基本値  
    レベルがIからⅢで評価される  
    脆弱性そのものの特性を評価する基準です。  
    情報システムに求められる3つのセキュリティ特性、『機密性(Confidentiality Impact)」、『完全性(Integrity Impact)」、『可用性(Availability Impact)」に対する影響を、ネットワークから攻撃可能かどうかといった基準で評価し、CVSS基本値(Base Score)を算出します。      この基準による評価結果は固定していて、時間の経過や利用環境の異なりによって変化しません。  
    ベンダーや脆弱性を公表する組織などが、脆弱性の固有の深刻度を表すために評価する基準です。  

- CVSS現状値  
    脆弱性の現在の深刻度を評価する基準です。  
    攻撃コードの出現有無や対策情報が利用可能であるかといった基準で評価し、CVSS現状値(Temporal Score)を算出します。  
    この基準による評価結果は、脆弱性への対応状況に応じ、時間が経過すると変化します。  
    ベンダーや脆弱性を公表する組織などが、脆弱性の現状を表すために評価する基準です。  

- CVSS環境値  
    ユーザの利用環境も含め、最終的な脆弱性の深刻度を評価する基準です。  
    脆弱性の対処状況を評価し、CVSS環境値(Environmental Score)を算出します。  
    この基準による評価結果は、脆弱性に対して想定される脅威に応じ、ユーザ毎に変化します。  
    ユーザが脆弱性への対応を決めるために評価する基準です。  

- FIDO認証  
    FIDO認証は、パスワードを使わずにオンラインサービスのID認証を安全で簡単に行うことができる新しい認証規格です。  
    非営利団体FIDOアライアンスがグローバルで標準化と普及を進めています。  

- CSIRT  
    CSIRT（Computer Security Incident Response Team）とは、セキュリティ上の問題として捉えられる事象であるインシデントが発生した際に対応するチームを指します。  
    業務としては、脆弱性情報などの収集と分析、インシデント発生時の対応、社内外の組織との情報共有や連携などが挙げられます。  

- CISO  
    CISO（Chief Information Security Officer）は最高情報セキュリティ責任者と訳され、企業における情報セキュリティを統括する責任者を指します。  

- SOC  
    サイバー攻撃の検知や分析を行い、その対策を講じることなどを専門とする組織をSOC（Security Operation Center）と呼びます。  
    SOCの主な業務は、各種セキュリティ装置やネットワーク機器、サーバーの監視やそれらから出力されるログの分析、サイバー攻撃を受けた場合の影響範囲の特定、サイバー攻撃を阻止するためのセキュリティ対策の立案などです。  

- EDR  
    EDR（Endpoint Detection and Response）とは、ユーザーが利用するパソコンやサーバー（エンドポイント）における不審な挙動を検知し、迅速な対応を支援するソリューションです。  


## Web技術

- コンテンツセキュリティポリシー (CSP)  
    コンテンツセキュリティポリシー (CSP) は、クロスサイトスクリプティング (Cross-site_scripting) やデータインジェクション攻撃などのような、特定の種類の攻撃を検知し、影響を軽減するために追加できるセキュリティレイヤーです。  
    これらの攻撃はデータの窃取からサイトの改ざん、マルウェアの拡散に至るまで、様々な目的に用いられます。  

    ```html
    Content-Security-Policy: default-src 'self' example.com *.example.com
    ```

- Strict-Transport-Security  
    HTTP の Strict-Transport-Security レスポンスヘッダー (しばしば HSTS と略されます) は、ウェブサイトがブラウザーに HTTP の代わりに HTTPS を用いて通信を行うよう指示するためのものです。  

    ```html
    Strict-Transport-Security: max-age=<expire-time>
    Strict-Transport-Security: max-age=<expire-time>; includeSubDomains
    Strict-Transport-Security: max-age=<expire-time>; preload
    ```

- X-Content-Type-Options  
    X-Content-Type-Options は HTTP のレスポンスヘッダーで、 Content-Type ヘッダーで示された MIME タイプを変更せずに従うべきであることを示すために、サーバーによって使用されるマーカーです。  
    これにより、MIME タイプのスニッフィングを抑止することができます。  
    言い替えれば、 MIME タイプを意図的に設定することができます。  

- X-Frame-Options  
    X-Frame-Options は HTTP のレスポンスヘッダーで、ブラウザーがページを <frame>、<iframe>、<embed>、<object> の中に表示することを許可するかどうかを示すために使用します。  
    サイトはコンテンツが他のサイトに埋め込まれないよう保証することで、クリックジャッキング攻撃を防ぐために使用することができます。  

    ```html
    X-Frame-Options: DENY
    X-Frame-Options: SAMEORIGIN
    ```

- X-XSS-Protection  
    HTTP の X-XSS-Protection レスポンスヘッダーは Internet Explorer, Chrome, Safari の機能で、反射型クロスサイトスクリプティング (XSS) 攻撃を検出したときに、ページの読み込みを停止するためのものです。  
    強い Content-Security-Policy をサイトが実装して、インライン JavaScript の使用を無効にしていれば ('unsafe-inline')、現在のブラウザーではこれらの防御は大枠で不要なものですが、まだ CSP に対応していない古いウェブブラウザーを使用しているユーザーには防御になります。  
    
    ```html
    X-XSS-Protection: 0
    X-XSS-Protection: 1
    X-XSS-Protection: 1; mode=block
    X-XSS-Protection: 1; report=<reporting-uri>
    ```
    

## ECBモード    -> 弱い
## CBCモード    -> 強い

# 漢字
## 宛先
## 迂回
## 権威
## 改竄
## 傍受
## 踏み台
## 脆弱性
## 危殆化
## 偽装
## 鍵交換
## 遮断
## 帯域
## 廃棄
## 監視
## 検知
## 窃取
